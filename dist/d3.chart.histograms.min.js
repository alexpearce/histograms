/* d3.chart.histograms 02-06-2014 */
!function(a){"use strict";a.chart("BaseChart",{initialize:function(){var a=this;a.base.classed("BaseChart",!0),a.margins={top:10,bottom:40,left:60,right:10,padding:10},a._width=a.base.attr("width")?a.base.attr("width")-(a.margins.right+a.margins.left):200,a._height=a.base.attr("height")?a.base.attr("height")-(a.margins.top+a.margins.bottom):200,a.updateContainerWidth(),a.updateContainerHeight(),a.base.append("g").attr("transform","translate("+this.margins.left+","+this.margins.top+")"),a.areas={},a.layers={}},width:function(a){if(0===arguments.length)return this._width;var b=this._width;return this._width=a,this.updateContainerWidth(),this.trigger("change:width",a,b),this},height:function(a){if(0===arguments.length)return this._height;var b=this._height;return this._height=a,this.updateContainerHeight(),this.trigger("change:height",a,b),this},updateContainerWidth:function(){this.base.attr("width",this._width+this.margins.left+this.margins.right)},updateContainerHeight:function(){this.base.attr("height",this._height+this.margins.top+this.margins.bottom)}})}(window.d3),function(a){"use strict";a.chart("BaseChart").extend("AxesChart",{initialize:function(){var b=this;b.base.classed("AxesChart",!0),b._xAxisLabel="",b._yAxisLabel="",b._xExponent=0,b._yExponent=0,b.xScale=a.scale.linear().range([0,b.width()]),b.yScale=a.scale.linear().range([b.height(),0]);var c=b.base.select("g"),d=function(b,c,d){var e=a.svg.axis();return e.ticks(c).scale(b).orient(d).innerTickSize(-e.innerTickSize()).outerTickSize(-e.outerTickSize()).tickPadding(e.tickPadding()+4)};b.areas.xgrid=c.append("g").classed("x grid",!0).attr("transform","translate(0,"+b.height()+")"),b.areas.ygrid=c.append("g").classed("y grid",!0),b.areas.xaxis=c.append("g").classed("x axis",!0).attr("transform","translate(0,"+b.height()+")"),b.areas.xaxistop=c.append("g").classed("x axis",!0),b.areas.yaxis=c.append("g").classed("y axis",!0),b.areas.yaxisright=c.append("g").classed("y axis",!0).attr("transform","translate("+b.width()+", 0)"),b.areas.xlabel=b.base.append("g").classed("x axis-label",!0).attr("transform","translate("+(b.width()+b.margins.left)+","+(b.height()+b.margins.top+b.margins.bottom)+")"),b.areas.xlabel.append("text").attr("text-anchor","end").attr("dy","-0.2em"),b.areas.ylabel=b.base.append("g").classed("y axis-label",!0).attr("transform","rotate(-90) translate("+-b.margins.top+")"),b.areas.ylabel.append("text").attr("text-anchor","end").attr("dy","1em");var e=5,f=5;b.layers.xaxis=d(b.xScale,e,"bottom"),b.layers.xaxistop=d(b.xScale,e,"top").tickFormat(""),b.layers.xgrid=d(b.xScale,e,"bottom").tickSize(-b.height(),0,0).tickFormat(""),b.layers.yaxis=d(b.yScale,f,"left"),b.layers.yaxisright=d(b.yScale,f,"right").tickFormat(""),b.layers.ygrid=d(b.yScale,f,"left").tickSize(-b.width(),0,0).tickFormat("");var g=function(a){return Math.floor(Math.log(Math.abs(a))/Math.LN10)},h=function(b){var c=b,d=a.extent(c),e=g(d[0]),f=g(d[1]),h=a.max([f,e]);return 3*Math.floor(h/3)},i=function(a,b,c){return function(d){var e=a.ticks(b.ticks()[0]),f=h(e),i=e.map(function(a){return a/Math.pow(10,f)}),j=g(i[0]-i[1]);return j=0>j?Math.abs(j):0,"function"==typeof c&&c(f),(d/Math.pow(10,f)).toFixed(j)}},j=i(b.xScale,b.layers.xaxis,function(a){b._xExponent=a,b.xAxisLabel(b.xAxisLabel())}),k=i(b.yScale,b.layers.yaxis,function(a){b._yExponent=a,b.yAxisLabel(b.yAxisLabel())});b.layers.xaxis.tickFormat(j),b.layers.yaxis.tickFormat(k),b.on("change:width",function(){b.xScale.range([0,b.width()]),b.areas.xlabel.attr("transform","translate("+(b.width()+b.margins.left)+","+(b.height()+b.margins.top+b.margins.bottom)+")"),b.areas.yaxisright.attr("transform","translate("+b.width()+", 0)"),b.layers.ygrid.tickSize(-b.width(),0,0)}),b.on("change:height",function(){b.yScale.range([b.height(),0]),b.areas.xaxis.attr("transform","translate(0,"+b.height()+")"),b.areas.xgrid.attr("transform","translate(0,"+b.height()+")"),b.areas.xlabel.attr("transform","translate("+(b.width()+b.margins.left)+","+(b.height()+b.margins.top+b.margins.bottom)+")"),b.layers.xgrid.tickSize(-b.height(),0,0)})},drawAxes:function(a){var b=this,c=a===!0?250:0;b.areas.xaxis.transition().duration(c).call(b.layers.xaxis),b.areas.xaxistop.transition().duration(c).call(b.layers.xaxistop),b.areas.xgrid.transition().duration(c).call(b.layers.xgrid),b.areas.yaxis.transition().duration(c).call(b.layers.yaxis),b.areas.yaxisright.transition().duration(c).call(b.layers.yaxisright),b.areas.ygrid.transition().duration(c).call(b.layers.ygrid)},xAxisLabel:function(a){return 0===arguments.length?this._xAxisLabel:(this._xAxisLabel=a,this.areas.xlabel.select("text").text(0!==this._xExponent?this.xAxisLabel()+" ×1e"+this._xExponent:this.xAxisLabel()),this)},yAxisLabel:function(a){return 0===arguments.length?this._yAxisLabel:(this._yAxisLabel=a,this.areas.ylabel.select("text").text(0!==this._yExponent?this.yAxisLabel()+" ×1e"+this._yExponent:this.yAxisLabel()),this)}})}(window.d3),function(a){"use strict";a.chart("AxesChart").extend("Histogram",{initialize:function(){var b=this;b.base.classed("Histogram",!0);var c=b.base.select("g");b.layers.line=c.insert("g",".axis").classed("line",!0);var d=a.svg.area().interpolate("step-before").x(function(a){return b.xScale(a.dx)}).y1(function(a){return b.yScale(a.y)}).y0(function(){return a.max(b.yScale.range())});b.layer("line",b.layers.line,{dataBind:function(a){return this.selectAll("path").data([a])},insert:function(){return this.append("path").classed("line",!0).attr("fill","none").attr("stroke","rgb(38, 17, 150)")},events:{enter:function(){return this.attr("d",d)},update:function(){return this},"update:transition":function(){return this.attr("d",d)}}})},transform:function(b){var c=this;c.data=b;var d=a.extent(b.map(function(a){return a.x})),e=a.extent(b.map(function(a){return a.dx})),f=.05*Math.abs(d[0]-e[1]),g=a.extent(b,function(a){return a.y});c.xScale.domain([d[0]-f,e[1]+f]);var h=g[0]>0?0:g[0];return c.yScale.domain([h,1.05*g[1]]),c.drawAxes(),b}})}(window.d3),function(a){"use strict";a.chart("AxesChart").extend("Histogram2D",{initialize:function(){var b=this;b.base.classed("Histogram2D",!0),b.zScale=a.scale.linear().range(["#2c7bb6","#ffffbf","#d7191c"]).interpolate(a.interpolateHcl);var c=b.base.select("g");b.margins.right=100,b.areas.legend=b.base.append("g").classed("legend",!0).attr("transform",function(){return"translate("+(b.width()+b.margins.left+10)+","+b.margins.top+")"}),b.layers.tiles=c.insert("g",":first-child").classed("tiles",!0),b.on("change:width",function(){b.areas.legend.attr("transform",function(){return"translate("+(b.width()+b.margins.left+10)+","+b.margins.top+")"})}),b.layer("rect",b.layers.tiles,{dataBind:function(a){return this.selectAll("rect").data(a.data)},insert:function(){return this.append("rect").classed("tiles",!0)},events:{enter:function(){return this.attr("x",function(a){return b.xScale(a.xlow)}).attr("y",function(a){return b.yScale(a.yup)}).attr("width",function(a){return b.xScale(a.xup-a.xlow)-b.xScale(0)}).attr("height",function(a){return b.yScale(0)-b.yScale(a.yup-a.ylow)}).style("fill",function(a){return b.zScale(a.val)})},update:function(){return this}}})},transform:function(b){var c=this;c.data=b.data;var d=a.extent(c.data,function(a){return a.xlow}),e=a.extent(c.data,function(a){return a.xup}),f=a.extent(c.data,function(a){return a.ylow}),g=a.extent(c.data,function(a){return a.yup});c.xScale.domain([d[0],e[1]]),c.yScale.domain([f[0],g[1]]);var h=a.max(c.data,function(a){return a.val});return c.zScale.domain([0,h/2,h]),c.drawAxes(),c.drawColorLabel(),b},drawColorLabel:function(){var a=this,b=a.zScale.ticks(20).reverse(),c=(Math.abs(b[0]-b[1]),25),d=a.height()/b.length,e=a.areas.legend.selectAll(".legend-item").data(b).enter().append("g").attr("class","legend-item").attr("transform",function(a,b){return"translate(0, "+b*d+")"});e.append("rect").attr("width",c).attr("height",d).style("fill",a.zScale),e.append("text").attr("x",c+5).attr("y",d/2).attr("dy",".35em").text(String),a.areas.legend.append("rect").attr("width",c).attr("height",d*b.length).classed("legend-box",!0).style("fill","none")}})}(window.d3),function(a){"use strict";a.chart("Histogram").extend("HistogramZoom",{initialize:function(){var b=this;b.base.classed("HistogramZoom",!0);var c=b.base.append("defs").append("clipPath").attr("id","chartArea").append("rect").attr("width",b.width()).attr("height",b.height());b.layers.line.attr("clip-path","url(#chartArea)");var d=function(a){b.xScale.domain(a),b.drawAxes(!0),b.layers.line.draw(b.data)},e=100,f=40,g=10,h=a.svg.brush().x(b.xScale).on("brushend",function(){if(h.empty()!==!0){var a=b.base.select(".clear-button");if(a.empty()===!0){b.xScale.originalDomain=b.xScale.domain();var c=b.base.append("g").classed("clear-button",!0).attr("transform","translate("+(b.width()+b.margins.left-e-g)+","+(b.margins.top+g)+")");c.append("rect").attr("width",e).attr("height",f).attr("rx",2).attr("ry",2),c.append("text").attr("x",10).attr("y",25).text("Clear zoom"),c.on("click",function(){b.base.select(".brush").call(h.clear()),d(b.xScale.originalDomain),c.remove()})}d(h.extent()),b.base.select(".brush").call(h.clear())}});b.areas.brush=b.base.append("g").classed("brush",!0).attr("transform","translate("+b.margins.left+", "+b.margins.top+")"),b.areas.brush.call(h).selectAll("rect").attr("height",b.height()),b.on("change:height",function(){c.attr("height",b.height()),b.areas.brush.call(h).selectAll("rect").attr("height",b.height())}),b.on("change:width",function(){c.attr("width",b.width())})}})}(window.d3);